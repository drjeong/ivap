(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(root["_Highcharts"],root["_Highcharts"]["SeriesRegistry"],root["_Highcharts"]["SVGRenderer"],root["_Highcharts"]["Point"],root["_Highcharts"]["Color"],root["_Highcharts"]["SVGElement"]);else if(typeof define==="function"&&define.amd)define("highcharts/modules/treegraph",["highcharts/highcharts"],function(amd1){return factory(amd1,amd1["SeriesRegistry"],amd1["SVGRenderer"],amd1["Point"],amd1["Color"],amd1["SVGElement"])});else if(typeof exports==="object")exports["highcharts/modules/treegraph"]=factory(root["_Highcharts"],root["_Highcharts"]["SeriesRegistry"],root["_Highcharts"]["SVGRenderer"],root["_Highcharts"]["Point"],root["_Highcharts"]["Color"],root["_Highcharts"]["SVGElement"]);else root["Highcharts"]=factory(root["Highcharts"],root["Highcharts"]["SeriesRegistry"],root["Highcharts"]["SVGRenderer"],root["Highcharts"]["Point"],root["Highcharts"]["Color"],root["Highcharts"]["SVGElement"])})(typeof window==="undefined"?this:window,(__WEBPACK_EXTERNAL_MODULE__944__,__WEBPACK_EXTERNAL_MODULE__512__,__WEBPACK_EXTERNAL_MODULE__540__,__WEBPACK_EXTERNAL_MODULE__260__,__WEBPACK_EXTERNAL_MODULE__620__,__WEBPACK_EXTERNAL_MODULE__28__)=>{return(()=>{"use strict";var __webpack_modules__={620:module=>{module.exports=__WEBPACK_EXTERNAL_MODULE__620__},260:module=>{module.exports=__WEBPACK_EXTERNAL_MODULE__260__},28:module=>{module.exports=__WEBPACK_EXTERNAL_MODULE__28__},540:module=>{module.exports=__WEBPACK_EXTERNAL_MODULE__540__},512:module=>{module.exports=__WEBPACK_EXTERNAL_MODULE__512__},944:module=>{module.exports=__WEBPACK_EXTERNAL_MODULE__944__}};var __webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports}var module=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId](module,module.exports,__webpack_require__);return module.exports}(()=>{__webpack_require__.n=module=>{var getter=module&&module.__esModule?()=>module["default"]:()=>module;__webpack_require__.d(getter,{a:getter});return getter}})();(()=>{__webpack_require__.d=(exports,definition)=>{for(var key in definition){if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){Object.defineProperty(exports,key,{enumerable:true,get:definition[key]})}}}})();(()=>{__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop)})();var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{default:()=>treegraph_src});var highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_=__webpack_require__(944);var highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default=__webpack_require__.n(highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_);const getLinkPath={default:getDefaultPath,straight:getStraightPath,curved:getCurvedPath};function getDefaultPath(pathParams){const{x1,y1,x2,y2,width=0,inverted=false,radius,parentVisible}=pathParams;const path=[["M",x1,y1],["L",x1,y1],["C",x1,y1,x1,y2,x1,y2],["L",x1,y2],["C",x1,y1,x1,y2,x1,y2],["L",x1,y2]];return parentVisible?applyRadius([["M",x1,y1],["L",x1+width*(inverted?-.5:.5),y1],["L",x1+width*(inverted?-.5:.5),y2],["L",x2,y2]],radius):path}function getStraightPath(pathParams){const{x1,y1,x2,y2,width=0,inverted=false,parentVisible}=pathParams;return parentVisible?[["M",x1,y1],["L",x1+width*(inverted?-1:1),y2],["L",x2,y2]]:[["M",x1,y1],["L",x1,y2],["L",x1,y2]]}function getCurvedPath(pathParams){const{x1,y1,x2,y2,offset=0,width=0,inverted=false,parentVisible}=pathParams;return parentVisible?[["M",x1,y1],["C",x1+offset,y1,x1-offset+width*(inverted?-1:1),y2,x1+width*(inverted?-1:1),y2],["L",x2,y2]]:[["M",x1,y1],["C",x1,y1,x1,y2,x1,y2],["L",x2,y2]]}function applyRadius(path,r){const d=[];for(let i=0;i<path.length;i++){const x=path[i][1];const y=path[i][2];if(typeof x==="number"&&typeof y==="number"){if(i===0){d.push(["M",x,y])}else if(i===path.length-1){d.push(["L",x,y])}else if(r){const prevSeg=path[i-1];const nextSeg=path[i+1];if(prevSeg&&nextSeg){const x1=prevSeg[1],y1=prevSeg[2],x2=nextSeg[1],y2=nextSeg[2];if(typeof x1==="number"&&typeof x2==="number"&&typeof y1==="number"&&typeof y2==="number"&&x1!==x2&&y1!==y2){const directionX=x1<x2?1:-1,directionY=y1<y2?1:-1;d.push(["L",x-directionX*Math.min(Math.abs(x-x1),r),y-directionY*Math.min(Math.abs(y-y1),r)],["C",x,y,x,y,x+directionX*Math.min(Math.abs(x-x2),r),y+directionY*Math.min(Math.abs(y-y2),r)])}}}else{d.push(["L",x,y])}}}return d}const PathUtilities={applyRadius:applyRadius,getLinkPath:getLinkPath};const Series_PathUtilities=PathUtilities;var highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_=__webpack_require__(512);var highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default=__webpack_require__.n(highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_);var highcharts_SVGRenderer_commonjs_highcharts_SVGRenderer_commonjs2_highcharts_SVGRenderer_root_Highcharts_SVGRenderer_=__webpack_require__(540);var highcharts_SVGRenderer_commonjs_highcharts_SVGRenderer_commonjs2_highcharts_SVGRenderer_root_Highcharts_SVGRenderer_default=__webpack_require__.n(highcharts_SVGRenderer_commonjs_highcharts_SVGRenderer_commonjs2_highcharts_SVGRenderer_root_Highcharts_SVGRenderer_);const{seriesTypes:{treemap:{prototype:{NodeClass:TreemapNode}}}}=highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default();class TreegraphNode extends TreemapNode{constructor(){super(...arguments);this.mod=0;this.shift=0;this.change=0;this.children=[];this.preX=0;this.hidden=false;this.wasVisited=false;this.collapsed=false}nextLeft(){return this.getLeftMostChild()||this.thread}nextRight(){return this.getRightMostChild()||this.thread}getAncestor(leftIntNode,defaultAncestor){const leftAnc=leftIntNode.ancestor;if(leftAnc.children[0]===this.children[0]){return leftIntNode.ancestor}return defaultAncestor}getLeftMostSibling(){const parent=this.getParent();if(parent){for(const child of parent.children){if(child&&child.point.visible){return child}}}}hasChildren(){const children=this.children;for(let i=0;i<children.length;i++){if(children[i].point.visible){return true}}return false}getLeftSibling(){const parent=this.getParent();if(parent){const children=parent.children;for(let i=this.relativeXPosition-1;i>=0;i--){if(children[i]&&children[i].point.visible){return children[i]}}}}getLeftMostChild(){const children=this.children;for(let i=0;i<children.length;i++){if(children[i].point.visible){return children[i]}}}getRightMostChild(){const children=this.children;for(let i=children.length-1;i>=0;i--){if(children[i].point.visible){return children[i]}}}getParent(){return this.parentNode}getFirstChild(){const children=this.children;for(let i=0;i<children.length;i++){if(children[i].point.visible){return children[i]}}}}const Treegraph_TreegraphNode=TreegraphNode;var highcharts_Point_commonjs_highcharts_Point_commonjs2_highcharts_Point_root_Highcharts_Point_=__webpack_require__(260);var highcharts_Point_commonjs_highcharts_Point_commonjs2_highcharts_Point_root_Highcharts_Point_default=__webpack_require__.n(highcharts_Point_commonjs_highcharts_Point_commonjs2_highcharts_Point_root_Highcharts_Point_);const{seriesTypes:{treemap:{prototype:{pointClass:TreemapPoint}}}}=highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default();const{addEvent,fireEvent,merge}=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();class TreegraphPoint extends TreemapPoint{constructor(){super(...arguments);this.dataLabelOnHidden=true;this.isLink=false;this.setState=highcharts_Point_commonjs_highcharts_Point_commonjs2_highcharts_Point_root_Highcharts_Point_default().prototype.setState}draw(){super.draw.apply(this,arguments);const graphic=this.graphic;if(graphic){graphic.animate({visibility:this.visible?"inherit":"hidden"})}this.renderCollapseButton()}renderCollapseButton(){const point=this,series=point.series,parentGroup=point.graphic&&point.graphic.parentGroup,levelOptions=series.mapOptionsToLevel[point.node.level||0]||{},btnOptions=merge(series.options.collapseButton,levelOptions.collapseButton,point.options.collapseButton),{width,height,shape,style}=btnOptions,padding=2,chart=this.series.chart,calculatedOpacity=point.visible&&(point.collapsed||!btnOptions.onlyOnHover||point.state==="hover")?1:0;if(!point.shapeArgs){return}this.collapseButtonOptions=btnOptions;if(!point.collapseButton){if(!point.node.children.length||!btnOptions.enabled){return}const{x,y}=this.getCollapseBtnPosition(btnOptions),fill=btnOptions.fillColor||point.color||"#cccccc";point.collapseButton=chart.renderer.label(point.collapsed?"+":"-",x,y,shape).attr({height:height-2*padding,width:width-2*padding,padding:padding,fill:fill,rotation:chart.inverted?90:0,rotationOriginX:width/2,rotationOriginY:height/2,stroke:btnOptions.lineColor||"#ffffff","stroke-width":btnOptions.lineWidth,"text-align":"center",align:"center",zIndex:1,opacity:calculatedOpacity,visibility:point.visible?"inherit":"hidden"}).addClass("highcharts-tracker").addClass("highcharts-collapse-button").removeClass("highcharts-no-tooltip").css(merge({color:typeof fill==="string"?chart.renderer.getContrast(fill):"#333333"},style)).add(parentGroup);point.collapseButton.element.point=point}else{if(!point.node.children.length||!btnOptions.enabled){point.collapseButton.destroy();delete point.collapseButton}else{const{x,y}=this.getCollapseBtnPosition(btnOptions);point.collapseButton.attr({text:point.collapsed?"+":"-",rotation:chart.inverted?90:0,rotationOriginX:width/2,rotationOriginY:height/2,visibility:point.visible?"inherit":"hidden"}).animate({x:x,y:y,opacity:calculatedOpacity})}}}toggleCollapse(state){const series=this.series;this.update({collapsed:state??!this.collapsed},false,void 0,false);fireEvent(series,"toggleCollapse");series.redraw()}destroy(){if(this.collapseButton){this.collapseButton.destroy();delete this.collapseButton;this.collapseButton=void 0}if(this.linkToParent){this.linkToParent.destroy();delete this.linkToParent}super.destroy.apply(this,arguments)}getCollapseBtnPosition(btnOptions){const point=this,chart=point.series.chart,inverted=chart.inverted,btnWidth=btnOptions.width,btnHeight=btnOptions.height,{x=0,y=0,width=0,height=0}=point.shapeArgs||{};return{x:x+btnOptions.x+(inverted?-btnHeight*.3:width+btnWidth*-.3),y:y+height/2-btnHeight/2+btnOptions.y}}}addEvent(TreegraphPoint,"mouseOut",function(){const btn=this.collapseButton,btnOptions=this.collapseButtonOptions;if(btn&&btnOptions?.onlyOnHover&&!this.collapsed){btn.animate({opacity:0})}});addEvent(TreegraphPoint,"mouseOver",function(){if(this.collapseButton&&this.visible){this.collapseButton.animate({opacity:1},this.series.options.states?.hover?.animation)}});addEvent(TreegraphPoint,"click",function(){this.toggleCollapse()});const Treegraph_TreegraphPoint=TreegraphPoint;var highcharts_Color_commonjs_highcharts_Color_commonjs2_highcharts_Color_root_Highcharts_Color_=__webpack_require__(620);var highcharts_Color_commonjs_highcharts_Color_commonjs2_highcharts_Color_root_Highcharts_Color_default=__webpack_require__.n(highcharts_Color_commonjs_highcharts_Color_commonjs2_highcharts_Color_root_Highcharts_Color_);const{extend,isArray,isNumber,isObject,merge:TreeUtilities_merge,pick,relativeLength}=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();function getColor(node,options){const index=options.index,mapOptionsToLevel=options.mapOptionsToLevel,parentColor=options.parentColor,parentColorIndex=options.parentColorIndex,series=options.series,colors=options.colors,siblings=options.siblings,points=series.points,chartOptionsChart=series.chart.options.chart;let getColorByPoint,point,level,colorByPoint,colorIndexByPoint,color,colorIndex;const variateColor=color=>{const colorVariation=level&&level.colorVariation;if(colorVariation&&colorVariation.key==="brightness"&&index&&siblings){return highcharts_Color_commonjs_highcharts_Color_commonjs2_highcharts_Color_root_Highcharts_Color_default().parse(color).brighten(colorVariation.to*(index/siblings)).get()}return color};if(node){point=points[node.i];level=mapOptionsToLevel[node.level]||{};getColorByPoint=point&&level.colorByPoint;if(getColorByPoint){colorIndexByPoint=point.index%(colors?colors.length:chartOptionsChart.colorCount);colorByPoint=colors&&colors[colorIndexByPoint]}if(!series.chart.styledMode){color=pick(point&&point.options.color,level&&level.color,colorByPoint,parentColor&&variateColor(parentColor),series.color)}colorIndex=pick(point&&point.options.colorIndex,level&&level.colorIndex,colorIndexByPoint,parentColorIndex,options.colorIndex)}return{color:color,colorIndex:colorIndex}}function getLevelOptions(params){const result={};let defaults,converted,i,from,to,levels;if(isObject(params)){from=isNumber(params.from)?params.from:1;levels=params.levels;converted={};defaults=isObject(params.defaults)?params.defaults:{};if(isArray(levels)){converted=levels.reduce((obj,item)=>{let level,levelIsConstant,options;if(isObject(item)&&isNumber(item.level)){options=TreeUtilities_merge({},item);levelIsConstant=pick(options.levelIsConstant,defaults.levelIsConstant);delete options.levelIsConstant;delete options.level;level=item.level+(levelIsConstant?0:from-1);if(isObject(obj[level])){TreeUtilities_merge(true,obj[level],options)}else{obj[level]=options}}return obj},{})}to=isNumber(params.to)?params.to:1;for(i=0;i<=to;i++){result[i]=TreeUtilities_merge({},defaults,isObject(converted[i])?converted[i]:{})}}return result}function setTreeValues(tree,options){const before=options.before,idRoot=options.idRoot,mapIdToNode=options.mapIdToNode,nodeRoot=mapIdToNode[idRoot],levelIsConstant=options.levelIsConstant!==false,points=options.points,point=points[tree.i],optionsPoint=point&&point.options||{},children=[];let childrenTotal=0;tree.levelDynamic=tree.level-(levelIsConstant?0:nodeRoot.level);tree.name=pick(point&&point.name,"");tree.visible=idRoot===tree.id||options.visible===true;if(typeof before==="function"){tree=before(tree,options)}tree.children.forEach((child,i)=>{const newOptions=extend({},options);extend(newOptions,{index:i,siblings:tree.children.length,visible:tree.visible});child=setTreeValues(child,newOptions);children.push(child);if(child.visible){childrenTotal+=child.val}});const value=pick(optionsPoint.value,childrenTotal);tree.visible=value>=0&&(childrenTotal>0||tree.visible);tree.children=children;tree.childrenTotal=childrenTotal;tree.isLeaf=tree.visible&&!childrenTotal;tree.val=value;return tree}function updateRootId(series){let rootId,options;if(isObject(series)){options=isObject(series.options)?series.options:{};rootId=pick(series.rootNode,options.rootId,"");if(isObject(series.userOptions)){series.userOptions.rootId=rootId}series.rootNode=rootId}return rootId}function getNodeWidth(series,columnCount){const{chart,options}=series,{nodeDistance=0,nodeWidth=0}=options,{plotSizeX=1}=chart;if(nodeWidth==="auto"){if(typeof nodeDistance==="string"&&/%$/.test(nodeDistance)){const fraction=parseFloat(nodeDistance)/100,total=columnCount+fraction*(columnCount-1);return plotSizeX/total}const nDistance=Number(nodeDistance);return(plotSizeX+nDistance)/(columnCount||1)-nDistance}return relativeLength(nodeWidth,plotSizeX)}const TreeUtilities={getColor:getColor,getLevelOptions:getLevelOptions,getNodeWidth:getNodeWidth,setTreeValues:setTreeValues,updateRootId:updateRootId};const Series_TreeUtilities=TreeUtilities;const{pick:TreegraphLink_pick,extend:TreegraphLink_extend}=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();const{seriesTypes:{column:{prototype:{pointClass:ColumnPoint}}}}=highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default();class LinkPoint extends ColumnPoint{constructor(series,options,x,point){super(series,options,x);this.dataLabelOnNull=true;this.formatPrefix="link";this.isLink=true;this.node={};this.formatPrefix="link";this.dataLabelOnNull=true;if(point){this.fromNode=point.node.parentNode.point;this.visible=point.visible;this.toNode=point;this.id=this.toNode.id+"-"+this.fromNode.id}}update(options,redraw,animation,runEvent){const oldOptions={id:this.id,formatPrefix:this.formatPrefix};highcharts_Point_commonjs_highcharts_Point_commonjs2_highcharts_Point_root_Highcharts_Point_default().prototype.update.call(this,options,this.isLink?false:redraw,animation,runEvent);this.visible=this.toNode.visible;TreegraphLink_extend(this,oldOptions);if(TreegraphLink_pick(redraw,true)){this.series.chart.redraw(animation)}}}const TreegraphLink=LinkPoint;class TreegraphLayout{static createDummyNode(parent,child,gapSize){const dummyNode=new Treegraph_TreegraphNode;dummyNode.id=parent.id+"-"+gapSize;dummyNode.ancestor=parent;dummyNode.children.push(child);dummyNode.parent=parent.id;dummyNode.parentNode=parent;dummyNode.point=child.point;dummyNode.level=child.level-gapSize;dummyNode.relativeXPosition=child.relativeXPosition;dummyNode.visible=child.visible;parent.children[child.relativeXPosition]=dummyNode;child.oldParentNode=parent;child.relativeXPosition=0;child.parentNode=dummyNode;child.parent=dummyNode.id;return dummyNode}calculatePositions(series){const treeLayout=this;const nodes=series.nodeList;this.resetValues(nodes);const root=series.tree;if(root){treeLayout.calculateRelativeX(root,0);treeLayout.beforeLayout(nodes);treeLayout.firstWalk(root);treeLayout.secondWalk(root,-root.preX);treeLayout.afterLayout(nodes)}}beforeLayout(nodes){for(const node of nodes){for(let child of node.children){if(child&&child.level-node.level>1){let gapSize=child.level-node.level-1;while(gapSize>0){child=TreegraphLayout.createDummyNode(node,child,gapSize);gapSize--}}}}}resetValues(nodes){for(const node of nodes){node.mod=0;node.ancestor=node;node.shift=0;node.thread=void 0;node.change=0;node.preX=0}}calculateRelativeX(node,index){const treeLayout=this,children=node.children;for(let i=0,iEnd=children.length;i<iEnd;++i){treeLayout.calculateRelativeX(children[i],i)}node.relativeXPosition=index}firstWalk(node){const treeLayout=this,siblingDistance=1;let leftSibling;if(!node.hasChildren()){leftSibling=node.getLeftSibling();if(leftSibling){node.preX=leftSibling.preX+siblingDistance;node.mod=node.preX}else{node.preX=0}}else{let defaultAncestor=node.getLeftMostChild();for(const child of node.children){treeLayout.firstWalk(child);defaultAncestor=treeLayout.apportion(child,defaultAncestor)}treeLayout.executeShifts(node);const leftChild=node.getLeftMostChild(),rightChild=node.getRightMostChild(),midPoint=(leftChild.preX+rightChild.preX)/2;leftSibling=node.getLeftSibling();if(leftSibling){node.preX=leftSibling.preX+siblingDistance;node.mod=node.preX-midPoint}else{node.preX=midPoint}}}secondWalk(node,modSum){const treeLayout=this;node.yPosition=node.preX+modSum;node.xPosition=node.level;for(const child of node.children){treeLayout.secondWalk(child,modSum+node.mod)}}executeShifts(node){let shift=0,change=0;for(let i=node.children.length-1;i>=0;i--){const childNode=node.children[i];childNode.preX+=shift;childNode.mod+=shift;change+=childNode.change;shift+=childNode.shift+change}}apportion(node,defaultAncestor){const treeLayout=this,leftSibling=node.getLeftSibling();if(leftSibling){let rightIntNode=node,rightOutNode=node,leftIntNode=leftSibling,leftOutNode=rightIntNode.getLeftMostSibling(),rightIntMod=rightIntNode.mod,rightOutMod=rightOutNode.mod,leftIntMod=leftIntNode.mod,leftOutMod=leftOutNode.mod;while(leftIntNode&&leftIntNode.nextRight()&&rightIntNode&&rightIntNode.nextLeft()){leftIntNode=leftIntNode.nextRight();leftOutNode=leftOutNode.nextLeft();rightIntNode=rightIntNode.nextLeft();rightOutNode=rightOutNode.nextRight();rightOutNode.ancestor=node;const siblingDistance=1,shift=leftIntNode.preX+leftIntMod-(rightIntNode.preX+rightIntMod)+siblingDistance;if(shift>0){treeLayout.moveSubtree(node.getAncestor(leftIntNode,defaultAncestor),node,shift);rightIntMod+=shift;rightOutMod+=shift}leftIntMod+=leftIntNode.mod;rightIntMod+=rightIntNode.mod;leftOutMod+=leftOutNode.mod;rightOutMod+=rightOutNode.mod}if(leftIntNode&&leftIntNode.nextRight()&&!rightOutNode.nextRight()){rightOutNode.thread=leftIntNode.nextRight();rightOutNode.mod+=leftIntMod-rightOutMod}if(rightIntNode&&rightIntNode.nextLeft()&&!leftOutNode.nextLeft()){leftOutNode.thread=rightIntNode.nextLeft();leftOutNode.mod+=rightIntMod-leftOutMod}defaultAncestor=node}return defaultAncestor}moveSubtree(leftNode,rightNode,shift){const subtrees=rightNode.relativeXPosition-leftNode.relativeXPosition;rightNode.change-=shift/subtrees;rightNode.shift+=shift;rightNode.preX+=shift;rightNode.mod+=shift;leftNode.change+=shift/subtrees}afterLayout(nodes){for(const node of nodes){if(node.oldParentNode){node.relativeXPosition=node.parentNode.relativeXPosition;node.parent=node.oldParentNode.parent;node.parentNode=node.oldParentNode;delete node.oldParentNode.children[node.relativeXPosition];node.oldParentNode.children[node.relativeXPosition]=node;node.oldParentNode=void 0}}}}const Treegraph_TreegraphLayout=TreegraphLayout;const TreegraphSeriesDefaults={reversed:false,marker:{radius:10,lineWidth:0,symbol:"circle",fillOpacity:1,states:{}},link:{color:"#666666",lineWidth:1,radius:10,cursor:"default",type:"curved"},collapseButton:{onlyOnHover:true,enabled:true,lineWidth:1,x:0,y:0,height:18,width:18,shape:"circle",style:{cursor:"pointer",fontWeight:"bold",fontSize:"1em"}},fillSpace:false,tooltip:{linkFormat:"{point.fromNode.id} â†’ {point.toNode.id}",pointFormat:"{point.id}"},dataLabels:{defer:true,linkTextPath:{attributes:{startOffset:"50%"}},enabled:true,linkFormatter:()=>"",style:{textOverflow:"none"}},nodeDistance:30,nodeWidth:void 0};const Treegraph_TreegraphSeriesDefaults=TreegraphSeriesDefaults;var highcharts_SVGElement_commonjs_highcharts_SVGElement_commonjs2_highcharts_SVGElement_root_Highcharts_SVGElement_=__webpack_require__(28);var highcharts_SVGElement_commonjs_highcharts_SVGElement_commonjs2_highcharts_SVGElement_root_Highcharts_SVGElement_default=__webpack_require__.n(highcharts_SVGElement_commonjs_highcharts_SVGElement_commonjs2_highcharts_SVGElement_root_Highcharts_SVGElement_);const{deg2rad}=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();const{addEvent:TextPath_addEvent,merge:TextPath_merge,uniqueKey,defined,extend:TextPath_extend}=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();function setTextPath(path,textPathOptions){textPathOptions=TextPath_merge(true,{enabled:true,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},textPathOptions);const url=this.renderer.url,textWrapper=this.text||this,textPath=textWrapper.textPath,{attributes,enabled}=textPathOptions;path=path||textPath&&textPath.path;if(textPath){textPath.undo()}if(path&&enabled){const undo=TextPath_addEvent(textWrapper,"afterModifyTree",e=>{if(path&&enabled){let textPathId=path.attr("id");if(!textPathId){path.attr("id",textPathId=uniqueKey())}const textAttribs={x:0,y:0};if(defined(attributes.dx)){textAttribs.dx=attributes.dx;delete attributes.dx}if(defined(attributes.dy)){textAttribs.dy=attributes.dy;delete attributes.dy}textWrapper.attr(textAttribs);this.attr({transform:""});if(this.box){this.box=this.box.destroy()}const children=e.nodes.slice(0);e.nodes.length=0;e.nodes[0]={tagName:"textPath",attributes:TextPath_extend(attributes,{"text-anchor":attributes.textAnchor,href:`${url}#${textPathId}`}),children:children}}});textWrapper.textPath={path:path,undo:undo}}else{textWrapper.attr({dx:0,dy:0});delete textWrapper.textPath}if(this.added){textWrapper.textCache="";this.renderer.buildText(textWrapper)}return this}function setPolygon(event){const bBox=event.bBox,tp=this.element?.querySelector("textPath");if(tp){const polygon=[],{b,h}=this.renderer.fontMetrics(this.element),descender=h-b,lineCleanerRegex=new RegExp("(<tspan>|"+'<tspan(?!\\sclass="highcharts-br")[^>]*>|'+"<\\/tspan>)","g"),lines=tp.innerHTML.replace(lineCleanerRegex,"").split(/<tspan class="highcharts-br"[^>]*>/),numOfLines=lines.length;const appendTopAndBottom=(charIndex,positionOfChar)=>{const{x,y}=positionOfChar,rotation=(tp.getRotationOfChar(charIndex)-90)*deg2rad,cosRot=Math.cos(rotation),sinRot=Math.sin(rotation);return[[x-descender*cosRot,y-descender*sinRot],[x+b*cosRot,y+b*sinRot]]};for(let i=0,lineIndex=0;lineIndex<numOfLines;lineIndex++){const line=lines[lineIndex],lineLen=line.length;for(let lineCharIndex=0;lineCharIndex<lineLen;lineCharIndex+=5){try{const srcCharIndex=i+lineCharIndex+lineIndex,[lower,upper]=appendTopAndBottom(srcCharIndex,tp.getStartPositionOfChar(srcCharIndex));if(lineCharIndex===0){polygon.push(upper);polygon.push(lower)}else{if(lineIndex===0){polygon.unshift(upper)}if(lineIndex===numOfLines-1){polygon.push(lower)}}}catch(e){break}}i+=lineLen-1;try{const srcCharIndex=i+lineIndex,charPos=tp.getEndPositionOfChar(srcCharIndex),[lower,upper]=appendTopAndBottom(srcCharIndex,charPos);polygon.unshift(upper);polygon.unshift(lower)}catch(e){break}}if(polygon.length){polygon.push(polygon[0].slice())}bBox.polygon=polygon}return bBox}function drawTextPath(event){const labelOptions=event.labelOptions,point=event.point,textPathOptions=labelOptions[point.formatPrefix+"TextPath"]||labelOptions.textPath;if(textPathOptions&&!labelOptions.useHTML){this.setTextPath(point.getDataLabelPath?.(this)||point.graphic,textPathOptions);if(point.dataLabelPath&&!textPathOptions.enabled){point.dataLabelPath=point.dataLabelPath.destroy()}}}function compose(SVGElementClass){TextPath_addEvent(SVGElementClass,"afterGetBBox",setPolygon);TextPath_addEvent(SVGElementClass,"beforeAddingDataLabel",drawTextPath);const svgElementProto=SVGElementClass.prototype;if(!svgElementProto.setTextPath){svgElementProto.setTextPath=setTextPath}}const TextPath={compose:compose};const Extensions_TextPath=TextPath;const{getLinkPath:TreegraphSeries_getLinkPath}=Series_PathUtilities;const{series:{prototype:seriesProto},seriesTypes:{treemap:TreemapSeries,column:ColumnSeries}}=highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default();const{prototype:{symbols}}=highcharts_SVGRenderer_commonjs_highcharts_SVGRenderer_commonjs2_highcharts_SVGRenderer_root_Highcharts_SVGRenderer_default();const{getLevelOptions:TreegraphSeries_getLevelOptions,getNodeWidth:TreegraphSeries_getNodeWidth}=Series_TreeUtilities;const{arrayMax,crisp,extend:TreegraphSeries_extend,merge:TreegraphSeries_merge,pick:TreegraphSeries_pick,relativeLength:TreegraphSeries_relativeLength,splat}=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();Extensions_TextPath.compose(highcharts_SVGElement_commonjs_highcharts_SVGElement_commonjs2_highcharts_SVGElement_root_Highcharts_SVGElement_default());class TreegraphSeries extends TreemapSeries{constructor(){super(...arguments);this.nodeList=[];this.links=[]}init(){super.init.apply(this,arguments);this.layoutAlgorythm=new Treegraph_TreegraphLayout;const series=this,collectors=this.chart.labelCollectors,collectorFunc=function(){const linkLabels=[];if(series.options.dataLabels&&!splat(series.options.dataLabels)[0].allowOverlap){for(const link of series.links||[]){if(link.dataLabel){linkLabels.push(link.dataLabel)}}}return linkLabels};if(!collectors.some(f=>f.name==="collectorFunc")){collectors.push(collectorFunc)}}getLayoutModifiers(){const chart=this.chart,series=this,plotSizeX=chart.plotSizeX,plotSizeY=chart.plotSizeY,columnCount=arrayMax(this.points.map(p=>p.node.xPosition));let minX=Infinity,maxX=-Infinity,minY=Infinity,maxY=-Infinity,maxXSize=0,minXSize=0,maxYSize=0,minYSize=0;this.points.forEach(point=>{if(this.options.fillSpace&&!point.visible){return}const node=point.node,level=series.mapOptionsToLevel[point.node.level]||{},markerOptions=TreegraphSeries_merge(this.options.marker,level.marker,point.options.marker),nodeWidth=markerOptions.width??TreegraphSeries_getNodeWidth(this,columnCount),radius=TreegraphSeries_relativeLength(markerOptions.radius||0,Math.min(plotSizeX,plotSizeY)),symbol=markerOptions.symbol,nodeSizeY=symbol==="circle"||!markerOptions.height?radius*2:TreegraphSeries_relativeLength(markerOptions.height,plotSizeY),nodeSizeX=symbol==="circle"||!nodeWidth?radius*2:TreegraphSeries_relativeLength(nodeWidth,plotSizeX);node.nodeSizeX=nodeSizeX;node.nodeSizeY=nodeSizeY;let lineWidth;if(node.xPosition<=minX){minX=node.xPosition;lineWidth=markerOptions.lineWidth||0;minXSize=Math.max(nodeSizeX+lineWidth,minXSize)}if(node.xPosition>=maxX){maxX=node.xPosition;lineWidth=markerOptions.lineWidth||0;maxXSize=Math.max(nodeSizeX+lineWidth,maxXSize)}if(node.yPosition<=minY){minY=node.yPosition;lineWidth=markerOptions.lineWidth||0;minYSize=Math.max(nodeSizeY+lineWidth,minYSize)}if(node.yPosition>=maxY){maxY=node.yPosition;lineWidth=markerOptions.lineWidth||0;maxYSize=Math.max(nodeSizeY+lineWidth,maxYSize)}});const ay=maxY===minY?1:(plotSizeY-(minYSize+maxYSize)/2)/(maxY-minY),by=maxY===minY?plotSizeY/2:-ay*minY+minYSize/2,ax=maxX===minX?1:(plotSizeX-(maxXSize+maxXSize)/2)/(maxX-minX),bx=maxX===minX?plotSizeX/2:-ax*minX+minXSize/2;return{ax:ax,bx:bx,ay:ay,by:by}}getLinks(){const series=this;const links=[];this.data.forEach(point=>{const levelOptions=series.mapOptionsToLevel[point.node.level||0]||{};if(point.node.parent){const pointOptions=TreegraphSeries_merge(levelOptions,point.options);if(!point.linkToParent||point.linkToParent.destroyed){const link=new series.LinkClass(series,pointOptions,void 0,point);point.linkToParent=link}else{point.collapsed=TreegraphSeries_pick(point.collapsed,(this.mapOptionsToLevel[point.node.level]||{}).collapsed);point.linkToParent.visible=point.linkToParent.toNode.visible}point.linkToParent.index=links.push(point.linkToParent)-1}else{if(point.linkToParent){series.links.splice(point.linkToParent.index);point.linkToParent.destroy();delete point.linkToParent}}});return links}buildTree(id,index,level,list,parent){const point=this.points[index];level=point&&point.level||level;return super.buildTree.call(this,id,index,level,list,parent)}markerAttribs(){return{}}setCollapsedStatus(node,visibility){const point=node.point;if(point){point.collapsed=TreegraphSeries_pick(point.collapsed,(this.mapOptionsToLevel[node.level]||{}).collapsed);point.visible=visibility;visibility=visibility===false?false:!point.collapsed}node.children.forEach(childNode=>{this.setCollapsedStatus(childNode,visibility)})}drawTracker(){ColumnSeries.prototype.drawTracker.apply(this,arguments);ColumnSeries.prototype.drawTracker.call(this,this.links)}translate(){const series=this,options=series.options;let rootId=Series_TreeUtilities.updateRootId(series),rootNode;seriesProto.translate.call(series);const tree=series.tree=series.getTree();rootNode=series.nodeMap[rootId];if(rootId!==""&&(!rootNode||!rootNode.children.length)){series.setRootNode("",false);rootId=series.rootNode;rootNode=series.nodeMap[rootId]}series.mapOptionsToLevel=TreegraphSeries_getLevelOptions({from:rootNode.level+1,levels:options.levels,to:tree.height,defaults:{levelIsConstant:series.options.levelIsConstant,colorByPoint:options.colorByPoint}});this.setCollapsedStatus(tree,true);series.links=series.getLinks();series.setTreeValues(tree);this.layoutAlgorythm.calculatePositions(series);series.layoutModifier=this.getLayoutModifiers();this.points.forEach(point=>{this.translateNode(point)});this.points.forEach(point=>{if(point.linkToParent){this.translateLink(point.linkToParent)}});if(!options.colorByPoint){series.setColorRecursive(series.tree)}}translateLink(link){const fromNode=link.fromNode,toNode=link.toNode,linkWidth=this.options.link?.lineWidth||0,factor=TreegraphSeries_pick(this.options.link?.curveFactor,.5),type=TreegraphSeries_pick(link.options.link?.type,this.options.link?.type,"default");if(fromNode.shapeArgs&&toNode.shapeArgs){const fromNodeWidth=fromNode.shapeArgs.width||0,inverted=this.chart.inverted,y1=crisp((fromNode.shapeArgs.y||0)+(fromNode.shapeArgs.height||0)/2,linkWidth),y2=crisp((toNode.shapeArgs.y||0)+(toNode.shapeArgs.height||0)/2,linkWidth);let x1=crisp((fromNode.shapeArgs.x||0)+fromNodeWidth,linkWidth),x2=crisp(toNode.shapeArgs.x||0,linkWidth);if(inverted){x1-=fromNodeWidth;x2+=toNode.shapeArgs.width||0}const diff=toNode.node.xPosition-fromNode.node.xPosition;link.shapeType="path";const fullWidth=Math.abs(x2-x1)+fromNodeWidth,width=fullWidth/diff-fromNodeWidth,offset=width*factor*(inverted?-1:1);const xMiddle=crisp((x2+x1)/2,linkWidth);link.plotX=xMiddle;link.plotY=y2;link.shapeArgs={d:TreegraphSeries_getLinkPath[type]({x1:x1,y1:y1,x2:x2,y2:y2,width:width,offset:offset,inverted:inverted,parentVisible:toNode.visible,radius:this.options.link?.radius})};link.dlBox={x:(x1+x2)/2,y:(y1+y2)/2,height:linkWidth,width:0};link.tooltipPos=inverted?[(this.chart.plotSizeY||0)-link.dlBox.y,(this.chart.plotSizeX||0)-link.dlBox.x]:[link.dlBox.x,link.dlBox.y]}}drawNodeLabels(points){const series=this,mapOptionsToLevel=series.mapOptionsToLevel;let options,level;for(const point of points){level=mapOptionsToLevel[point.node.level];options={style:{}};if(level&&level.dataLabels){options=TreegraphSeries_merge(options,level.dataLabels);series.hasDataLabels=()=>true}if(point.shapeArgs&&series.options.dataLabels){const css={};let{width=0,height=0}=point.shapeArgs;if(series.chart.inverted){[width,height]=[height,width]}if(!splat(series.options.dataLabels)[0].style?.width){css.width=`${width}px`}if(!splat(series.options.dataLabels)[0].style?.lineClamp){css.lineClamp=Math.floor(height/16)}TreegraphSeries_extend(options.style,css);point.dataLabel?.css(css)}point.dlOptions=TreegraphSeries_merge(options,point.options.dataLabels)}seriesProto.drawDataLabels.call(this,points)}alignDataLabel(point,dataLabel){const visible=point.visible;point.visible=true;super.alignDataLabel.apply(this,arguments);dataLabel.animate({opacity:visible===false?0:1},void 0,function(){visible||dataLabel.hide()});point.visible=visible}drawDataLabels(){if(this.options.dataLabels){this.options.dataLabels=splat(this.options.dataLabels);this.drawNodeLabels(this.points);seriesProto.drawDataLabels.call(this,this.links)}}destroy(){if(this.links){for(const link of this.links){link.destroy()}this.links.length=0}return seriesProto.destroy.apply(this,arguments)}pointAttribs(point,state){const series=this,levelOptions=point&&series.mapOptionsToLevel[point.node.level||0]||{},options=point&&point.options,stateOptions=levelOptions.states&&levelOptions.states[state]||{};if(point){point.options.marker=TreegraphSeries_merge(series.options.marker,levelOptions.marker,point.options.marker)}const linkColor=TreegraphSeries_pick(stateOptions&&stateOptions.link&&stateOptions.link.color,options&&options.link&&options.link.color,levelOptions&&levelOptions.link&&levelOptions.link.color,series.options.link&&series.options.link.color),linkLineWidth=TreegraphSeries_pick(stateOptions&&stateOptions.link&&stateOptions.link.lineWidth,options&&options.link&&options.link.lineWidth,levelOptions&&levelOptions.link&&levelOptions.link.lineWidth,series.options.link&&series.options.link.lineWidth),attribs=seriesProto.pointAttribs.call(series,point,state);if(point){if(point.isLink){attribs.stroke=linkColor;attribs["stroke-width"]=linkLineWidth;delete attribs.fill}if(!point.visible){attribs.opacity=0}}return attribs}drawPoints(){TreemapSeries.prototype.drawPoints.apply(this,arguments);ColumnSeries.prototype.drawPoints.call(this,this.links)}translateNode(point){const chart=this.chart,node=point.node,plotSizeY=chart.plotSizeY,plotSizeX=chart.plotSizeX,{ax,bx,ay,by}=this.layoutModifier,x=ax*node.xPosition+bx,y=ay*node.yPosition+by,level=this.mapOptionsToLevel[node.level]||{},markerOptions=TreegraphSeries_merge(this.options.marker,level.marker,point.options.marker),symbol=markerOptions.symbol,height=node.nodeSizeY,width=node.nodeSizeX,reversed=this.options.reversed,nodeX=node.x=chart.inverted?plotSizeX-width/2-x:x-width/2,nodeY=node.y=!reversed?plotSizeY-y-height/2:y-height/2,borderRadius=TreegraphSeries_pick(point.options.borderRadius,level.borderRadius,this.options.borderRadius),symbolFn=symbols[symbol||"circle"];if(symbolFn===void 0){point.hasImage=true;point.shapeType="image";point.imageUrl=symbol.match(/^url\((.*?)\)$/)[1]}else{point.shapeType="path"}if(!point.visible&&point.linkToParent){const parentNode=point.linkToParent.fromNode;if(parentNode){const parentShapeArgs=parentNode.shapeArgs||{},{x=0,y=0,width=0,height=0}=parentShapeArgs;if(!point.shapeArgs){point.shapeArgs={}}if(!point.hasImage){TreegraphSeries_extend(point.shapeArgs,{d:symbolFn(x,y,width,height,borderRadius?{r:borderRadius}:void 0)})}TreegraphSeries_extend(point.shapeArgs,{x:x,y:y});point.plotX=parentNode.plotX;point.plotY=parentNode.plotY}}else{point.plotX=nodeX;point.plotY=nodeY;point.shapeArgs={x:nodeX,y:nodeY,width:width,height:height,cursor:!point.node.isLeaf?"pointer":"default"};if(!point.hasImage){point.shapeArgs.d=symbolFn(nodeX,nodeY,width,height,borderRadius?{r:borderRadius}:void 0)}}point.tooltipPos=chart.inverted?[plotSizeY-nodeY-height/2,plotSizeX-nodeX-width/2]:[nodeX+width/2,nodeY]}}TreegraphSeries.defaultOptions=TreegraphSeries_merge(TreemapSeries.defaultOptions,Treegraph_TreegraphSeriesDefaults);TreegraphSeries_extend(TreegraphSeries.prototype,{pointClass:Treegraph_TreegraphPoint,NodeClass:Treegraph_TreegraphNode,LinkClass:TreegraphLink});highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default().registerSeriesType("treegraph",TreegraphSeries);const Treegraph_TreegraphSeries=null&&TreegraphSeries;"";const treegraph_src=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();__webpack_exports__=__webpack_exports__["default"];return __webpack_exports__})()});